name: TruffleHog Secret Scanning

# This workflow is designed to be enforced org-wide via GitHub rulesets
# It calls the reusable TruffleHog workflow with sensible defaults for org-wide deployment

on:
  pull_request:
    types: [opened, synchronize, reopened]
  push:
    branches:
      - main

permissions:
  contents: read
  pull-requests: write
  checks: write

jobs:
  secret-scan:
    name: TruffleHog Secret Scan
    uses: ./.github/workflows/reusable-trufflehog.yml
    with:
      # Simplified workflow - only what you need
      fail-on-verified: "true"       # Always fail on real secrets
      fail-on-unverified: "false"    # Lenient for org-wide adoption
      runs-on: ${{ !github.event.repository.private && 'ubuntu-latest' || 'ubuntu-x86-large' }}    # Large runner for internal repositories
    secrets: inherit